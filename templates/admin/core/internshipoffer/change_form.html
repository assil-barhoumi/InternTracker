{% extends "admin/change_form.html" %}
{% load i18n admin_urls static admin_modify %}

{% block extrahead %}
{{ block.super }}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<style>
  :root {--success:#5cb85c;--danger:#d9534f;--light-blue:#cce5ff;--light-blue-border:#99ccff;}
  .card{border:1px solid #ddd;box-shadow:0 1px 3px rgba(0,0,0,.1);margin-bottom:1.5rem;}
  .card-header{background:#f8f8f8;font-weight:600;padding:.75rem 1.25rem;border-bottom:1px solid #eee;color:#666;font-size:13px;text-transform:uppercase;}
  .form-control,.form-select,.vDateField,.vTimeField{width:100%;margin-bottom:1rem;padding:6px 12px;border:1px solid #ccc;border-radius:4px;}
  .btn{font-weight:500;padding:6px 12px;font-size:13px;border-radius:4px;transition:.2s;}
  .btn-light-blue{background:#e7f1ff;border:1px solid #c2d7ff;color:#0d6efd;}
  .btn-light-blue:hover{background:#d0e2ff;border-color:#9ec5fe;}
  .btn-danger{background:var(--danger);border:1px solid var(--danger);color:#fff;}
  .badge{font-weight:500;padding:.25em .6em;font-size:11px;border-radius:10px;color:#000;}
  .bg-archived{background:#e2e3e5;}
  .alert-danger{background:#f8d7da;border-color:#f5c6cb;color:#721c24;}
</style>
{% endblock %}

{% block content %}
<div class="container-fluid py-3">
  <form {% if has_file_field %}enctype="multipart/form-data"{% endif %} {% if form_url %}action="{{ form_url }}"{% endif %} method="post" novalidate>
    {% csrf_token %}

    {% if errors %}
      <div class="alert alert-danger">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>{% trans "Please correct the errors below." %}
        {{ adminform.form.non_field_errors }}
      </div>
    {% endif %}

    <div class="row">
      <div class="col-lg-8">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <span><i class="bi bi-briefcase me-2"></i>{% trans "Offer Details" %}</span>
            <span class="badge {% if original and original.is_archived %}bg-archived{% else %}" style="background-color: #d4edda; color: #155724;"{% endif %}>
              {% if original and original.is_archived %}{% trans "Archived" %}{% else %}{% trans "Active" %}{% endif %}
            </span>
          </div>
          <div class="card-body">
            {% for fieldset in adminform %}
              {% if "is_archived" not in fieldset.fields %}
                {% include "admin/includes/fieldset.html" %}
              {% endif %}
            {% endfor %}

            {% if 'is_archived' in adminform.form.fields %}
              <div class="mt-3 pt-3 border-top">
                {{ adminform.form.is_archived.label_tag }}
                <div class="form-check form-switch">{{ adminform.form.is_archived }}</div>
              </div>
            {% endif %}
          </div>
        </div>
      </div>

      <div class="col-lg-4">
        <div class="card mb-4">
          <div class="card-header">{% trans "Actions" %}</div>
          <div class="card-body d-grid gap-2">
            <button type="submit" name="_save" class="btn btn-success"><i class="bi bi-save me-2"></i>{% trans "Save" %}</button>
            <button type="submit" name="_addanother" class="btn btn-outline-secondary"><i class="bi bi-plus-circle me-2"></i>{% trans "Save and add another" %}</button>
            <button type="submit" name="_continue" class="btn" style="background-color: #e7f1ff; border-color: #c2d7ff; color: #0d6efd;"><i class="bi bi-pencil me-2"></i>{% trans "Save and continue editing" %}</button>
            {% if show_delete_link and original %}
              <a href="{% url opts|admin_urlname:'delete' original.pk|admin_urlquote %}" class="btn btn-danger"><i class="bi bi-trash me-2"></i>{% trans "Delete" %}</a>
            {% endif %}
          </div>
        </div>
        {% for inline_admin_formset in inline_admin_formsets %}{% include inline_admin_formset.opts.template %}{% endfor %}
      </div>
    </div>
  </form>
</div>

<script>
document.addEventListener('DOMContentLoaded',()=>{
  document.querySelectorAll('input:not([type=checkbox]), select, textarea').forEach(e=>e.classList.add('form-control'));
  document.querySelectorAll('input[type=checkbox]').forEach(e=>e.classList.add('form-check-input'));
});
</script>
{% endblock %}